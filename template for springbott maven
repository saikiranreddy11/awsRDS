module "ecs_cluster" {
  source = "./ecs-cluster-module"  # Path to your module

  create                 = true
  cluster_name           = "dgx-prism-use-prd-ecs"  # Your ECS Cluster Name
  create_cloudwatch_log_group = true

  # CloudWatch Log Group for ECS Cluster
  cloudwatch_log_group_name              = "/aws/ecs/dgx-prism-use-prd"
  cloudwatch_log_group_retention_in_days = 14
  cloudwatch_log_group_kms_key_id        = null

  # ✅ Use Only Fargate On-Demand
  fargate_capacity_providers = {
    fargate = {
      name = "FARGATE"
    }
  }
  default_capacity_provider_use_fargate = true

  # ✅ Create a Shared Task Execution Role for the Cluster
  create_task_exec_iam_role = true
  task_exec_iam_role_name   = "ecs-task-execution-role-dgx-prism"
  task_exec_iam_role_policies = {
    ecs_task_exec = "arn:aws:iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy"
  }

  tags = {
    Environment = "prd"
    Application = "prism"
  }
}
